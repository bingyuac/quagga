{
  "data_block": {
    "blocking_context": ["seq_embd_block", "context"]
  },
  "seq_embd_block": {
    "type": "SequentialEmbeddingBlock",
    "indexes": {"data_block": "sentence_batch"},
    "embedding_init": ["Uniform", 10001, 512],
    "device_id": 0
  },
  "remove_last_block": {
    "type": "RemoveLastBlock",
    "x": {"seq_embd_block": "output"}
  },
  "fwd_lstm_block": {
    "type": "LstmRnnBlock",
    "W_z_init": ["Orthogonal", 512, 1024],
    "W_i_init": ["Orthogonal", 512, 1024],
    "W_f_init": ["Orthogonal", 512, 1024],
    "W_o_init": ["Orthogonal", 512, 1024],
    "R_z_init": ["Orthogonal", 1024, 1024],
    "R_i_init": ["Orthogonal", 1024, 1024],
    "R_f_init": ["Orthogonal", 1024, 1024],
    "R_o_init": ["Orthogonal", 1024, 1024],
    "x": {"remove_last_block": "output"},
    "mask": {"data_block": "mask"},
    "device_id": 0
  },
  "remove_first_block": {
    "type": "RemoveFirstBlock",
    "x": {"seq_embd_block": "output"}
  },
  "bwd_lstm_block": {
    "type": "LstmRnnBlock",
    "W_z_init": ["Orthogonal", 512, 1024],
    "W_i_init": ["Orthogonal", 512, 1024],
    "W_f_init": ["Orthogonal", 512, 1024],
    "W_o_init": ["Orthogonal", 512, 1024],
    "R_z_init": ["Orthogonal", 1024, 1024],
    "R_i_init": ["Orthogonal", 1024, 1024],
    "R_f_init": ["Orthogonal", 1024, 1024],
    "R_o_init": ["Orthogonal", 1024, 1024],
    "x": {"remove_first_block": "output"},
    "mask": {"data_block": "mask"},
    "reverse": true,
    "device_id": 0
  },
  "add_first_block": {
    "type": "AddFirstBlock",
    "x": {"fwd_lstm_block": "h"}
  },
  "add_last_block": {
    "type": "AddLastBlock",
    "x": {"bwd_lstm_block": "h"}
  },
  "seq_horizontal_stack": {
    "type": "SequentialHorizontalStackBlock",
    "x_sequence": {"add_first_block": "output"},
    "y_sequence": {"add_last_block": "output"},
    "device_id": 0
  },
  "seq_dot_block": {
    "type": "SequentialDotBlock",
    "W_init": ["Orthogonal", 2048, 10001],
    "b_init": ["Constant", 1, 10001],
    "x_sequence": {"seq_horizontal_stack": "output_sequence"},
    "device_id": 0
  },
  "seq_sce_block": {
    "type": "SequentialSoftmaxCeBlock",
    "x_sequence": {"seq_dot_block": "output_sequence"},
    "true_labels": {"data_block": "sentence_batch"}
  }
}